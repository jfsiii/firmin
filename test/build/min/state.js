(function(a){var b=(typeof exports==='object'),c=(typeof JS==='undefined')?require('./core'):JS;if(b)exports.JS=exports;a(c,b?exports:c)})(function(k,o){'use strict';var l=new k.Module('State',{__getState__:function(a){if(typeof a==='object')return a;if(typeof a==='string')return(this.states||{})[a];return{}},setState:function(a){this.__state__=this.__getState__(a);l.addMethods(this.__state__,this.klass)},inState:function(){var a=arguments.length;while(a--){if(this.__state__===this.__getState__(arguments[a]))return true}return false},extend:{ClassMethods:new k.Module({states:function(a){this.define('states',l.buildCollection(this,a))}}),included:function(a){a.extend(this.ClassMethods)},stub:function(){return this},buildStubs:function(a,b,c){var d,e;for(d in c){b[d]={};for(e in c[d])a[e]=this.stub}},findStates:function(a,b){var c=a.length,d=[];while(c--){if(a[c].hasOwnProperty(b))d.push(a[c][b])}return d},buildCollection:function(a,b){var c={},d={},e=a.lookup('states'),h,g,m,i,j,f,n;this.buildStubs(c,d,b);for(f=0,n=e.length;f<n;f++)this.buildStubs(c,d,e[f]);for(h in d){g=new k.Class(b[h]);j=this.findStates(e,h);f=j.length;while(f--){if(j[f])g.include(j[f].klass)}m={};for(i in c){if(!g.prototype[i])m[i]=c[i]}g.include(m);d[h]=new g}if(a.__tgt__)this.addMethods(c,a.__tgt__.klass);return d},addMethods:function(a,b){if(!b)return;var c={},d=b.prototype,e;for(e in a){if(d[e])continue;b.define(e,this.wrapped(e))}},wrapped:function(b){return function(){var a=(this.__state__||{})[b];return a?a.apply(this,arguments):this}}}});o.State=l});
//@ sourceMappingURL=state.js.map